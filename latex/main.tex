\documentclass[DIN, pagenumber=false, fontsize=11pt, parskip=half]{scrartcl}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{amsmath} 
\usepackage{graphicx}
\usepackage{float}
\usepackage[colorlinks=true, linkcolor=blue, urlcolor=blue]{hyperref}
\usepackage{circuitikz}


% for matlab code
% Remove 'bw' option to enable colored syntax highlighting
\usepackage[framed,numbered]{mcode}

\setlength{\parindent}{0em}

% Custom headers
\setkomafont{section}{\normalfont\bfseries\Large}
\setkomafont{subsection}{\normalfont\bfseries\large}

\newcommand{\mytitle}[1]{{\noindent\Huge\textbf{#1}}}
\newcommand{\mypart}[1]{\vspace{1cm}\hrule\vspace{0.5cm}\noindent\textbf{\LARGE #1}\vspace{0.5cm}\hrule\vspace{1cm}}
\newcommand{\myproblem}[1]{\subsection*{#1}}

%===================================
\begin{document}

\noindent\textbf{GENG8030-MATLAB} \hfill \textbf{University of Windsor}\\
Winter 2026 \hfill Bob Little\\

\mytitle{\Large Course Notes \hfill \today}

\vspace{1cm}
\noindent\textbf{\large Table of Contents}
\vspace{0.5cm}

\begin{itemize}
    \item \hyperref[tut1]{Tutorial 01: An Overview of MATLAB}
    \item \hyperref[tut2]{Tutorial 02: Numeric, Cell and Structure Arrays}
    \item \hyperref[tut3]{Tutorial 03: Functions}
    \item \hyperref[tut4]{Tutorial 04: Programming with MATLAB}
    \item \hyperref[tut9]{Tutorial 09: Numerical Methods}
    \item \hyperref[tut10]{Tutorial 10: Simulink}
\end{itemize}

\vspace{0.5cm}

%===================================
% TUTORIAL 1 SECTION
%===================================
\label{tut1}
\mypart{Tutorial 01: An Overview of MATLAB}

\input{sections/tut1_summary}

\vspace{1cm}
\hrule
\vspace{0.5cm}

\section*{Tutorial Problems}

\myproblem{Problem 3}
Suppose that $x=5$ and $y=2$. Use MATLAB to compute the following, and check the results with a calculator.
\begin{enumerate}
    \item[a.] $(1-\frac{1}{x^{5}})^{-1}$
    \item[b.] $3\pi x^{2}$
    \item[c.] $\frac{3y}{4x-8}$
    \item[d.] $\frac{4(y-5)}{3x-6}$
\end{enumerate}

\begin{lstlisting}
clear; clc;
x = 5;
y = 2;

% a. (1 - 1/x^5)^-1
result_a = (1 - 1/x^5)^-1;

% b. 3 * pi * x^2
result_b = 3 * pi * x^2;

% c. (3*y) / (4*x - 8)
result_c = (3*y) / (4*x - 8);

% d. (4*(y - 5)) / (3*x - 6)
result_d = (4*(y - 5)) / (3*x - 6);

% Display results
disp(table(result_a, result_b, result_c, result_d));
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 5}
Assuming that the variables a, b, c, d, and f are scalars, write MATLAB statements to compute and display the following expressions. Test your statements for the values $a=1.12$, $b=2.34$, $c=0.72$, $d=0.81$ and $f=19.83$.
\begin{itemize}
    \item $x=1+\frac{a}{b}+\frac{c}{f^{2}}$
    \item $r=\frac{1}{\frac{1}{a}+\frac{1}{b}+\frac{1}{c}+\frac{1}{d}}$
    \item $s=\frac{b-a}{d-c}$
    \item $y=ab\frac{1}{c}\frac{f^{2}}{2}$
\end{itemize}

\begin{lstlisting}
clear; clc;
a = 1.12; b = 2.34; c = 0.72; d = 0.81; f = 19.83;

x = 1 + a/b + c/f^2;
r = 1 / (1/a + 1/b + 1/c + 1/d);
s = (b - a) / (d - c);
y = a * b * (1/c) * (f^2/2);

disp(['x = ', num2str(x)]);
disp(['r = ', num2str(r)]);
disp(['s = ', num2str(s)]);
disp(['y = ', num2str(y)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 9}
The functions \texttt{realmax} and \texttt{realmin} give the largest and smallest possible numbers that can be handled by MATLAB.
Suppose you have variables $a=3\times10^{150}$, $b=5\times10^{200}$.
\begin{enumerate}
    \item[a.] Use MATLAB to calculate $c=ab$.
    \item[b.] Supposed $d=5\times10^{-200}$ use MATLAB to calculate $f=d/a$.
    \item[c.] Use MATLAB to calculate the product $x=abd$ two ways.
\end{enumerate}

\begin{lstlisting}
% Check limits
realmax
realmin

a = 3e150;
b = 5e200;

% a. Calculate c = a*b (Expect Overflow)
c = a * b 

% b. d = 5e-200, calculate f = d/a (Expect Underflow)
d = 5e-200;
f = d / a

% c. Calculate x = abd in two ways
x1 = a * b * d; % Risk of intermediate overflow
y = b * d;      
x2 = a * y;     % Safer calculation

disp(['Method 1: ', num2str(x1)]);
disp(['Method 2: ', num2str(x2)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 22}
Use MATLAB to calculate:
\begin{enumerate}
    \item[a.] $e^{(-2.1)^{3}}+3.47\log(14)+\sqrt[4]{287}$
    \item[b.] $(3.4)^{7}\log(14)+\sqrt[4]{287}$
    \item[c.] $\cos^{2}(\frac{4.12\pi}{6})$
    \item[d.] $\cos(\frac{4.12\pi}{6})^{2}$
\end{enumerate}

\begin{lstlisting}
% Note: Source likely implies log base 10 for "log(14)" in standard notation,
% but MATLAB's log() is natural log. Using log10() for base 10.
ans_a = exp((-2.1)^3) + 3.47 * log10(14) + nthroot(287, 4);
ans_b = (3.4)^7 * log10(14) + nthroot(287, 4);
ans_c = cos((4.12 * pi) / 6)^2;
ans_d = cos(((4.12 * pi) / 6)^2);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 27}
Use MATLAB to plot the function $T=7 \ln t-8e^{0.3t}$ over the interval $1\le t\le3$.

\begin{lstlisting}
t = 1:0.01:3; 
T = 7 .* log(t) - 8 .* exp(0.3 .* t);

plot(t, T);
title('Temperature vs Time');
xlabel('Time (min)');        
ylabel('Temperature (C)');   
grid on;
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 30}
A cycloid is described by $x=r(\phi-\sin~\phi)$ and $y=r(1-\cos~\phi)$. Plot for $r=10$ and $0\le\phi\le4\pi$.

\begin{lstlisting}
r = 10;
phi = 0 : 0.01 : 4*pi; 
x = r .* (phi - sin(phi));
y = r .* (1 - cos(phi));

plot(x, y);
title('Cycloid Plot (r=10)');
xlabel('x'); ylabel('y');
axis equal; 
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 34}
Develop a procedure for computing the length of side $c_{2}$ of the two-triangle figure given sides $b_{1}$, $b_{2}$, $c_{1}$ and angles $A_{1}$, $A_{2}$. Test with $b_{1}=200$, $b_{2}=180$, $c_{1}=120$, $A_{1}=120^{\circ}$, $A_{2}=100^{\circ}$.

\[
a^2 = b_1^2 + c_1^2 - 2b_1c_1 \cos A_1
\]

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/figure34.png}
\end{figure}

\begin{lstlisting}
% Inputs 
b1 = 200; b2 = 180; c1 = 120; 
A1_deg = 120; A2_deg = 100;
A1 = deg2rad(A1_deg); A2 = deg2rad(A2_deg);

% 1. Find common side 'a' (Top Triangle Law of Cosines)
a_sq = b1^2 + c1^2 - 2*b1*c1*cos(A1);
a = sqrt(a_sq);

% 2. Find c2 (Bottom Triangle) solving quadratic: 
% c2^2 - (2*b2*cos(A2))*c2 + (b2^2 - a^2) = 0
coeff_A = 1;
coeff_B = -2 * b2 * cos(A2);
coeff_C = b2^2 - a_sq;

possible_c2 = roots([coeff_A, coeff_B, coeff_C]);
c2 = possible_c2(possible_c2 > 0); % Filter positive

disp(['Side c2: ', num2str(c2')]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 35}
Write a script to compute the three roots of $x^{3}+ax^{2}+bx+c=0$.

\begin{lstlisting}
a = input('Enter a: ');
b = input('Enter b: ');
c = input('Enter c: ');
disp(roots([1, a, b, c]));
\end{lstlisting}


%===================================
% TUTORIAL 2 SECTION
%===================================
\newpage
\label{tut2}
\mypart{Tutorial 02: Numeric, Cell and Structure Arrays}

\input{sections/tut2_summary}

\vspace{1cm}
\hrule
\vspace{0.5cm}
\section*{Tutorial Problems}

\myproblem{Problem 10}
Consider the array $A = \begin{bmatrix}1&4&2\\ 2&4&100\\ 7&9&7\\ 3&\pi&42\end{bmatrix}$ and $B = \ln(A)$.

Write MATLAB expressions to do the following:
\begin{enumerate}
    \item[a.] Select just the second row of B.
    \item[b.] Evaluate the sum of the second row of B.
    \item[c.] Multiply the second column of B and the first column of A element by element.
    \item[d.] Evaluate the maximum value in the vector resulting from element-by-element multiplication of the second column of B with the first column of A.
    \item[e.] Use element-by-element division to divide the first row of A by the first three elements of the third column of B. Evaluate the sum of the elements of the resulting vector.
\end{enumerate}

\begin{lstlisting}
% Define Matrix A
A = [1, 4, 2;
     2, 4, 100;
     7, 9, 7;
     3, pi, 42];

% Define Matrix B (Natural log is log() in MATLAB)
B = log(A);

% a. Select second row of B
part_a = B(2, :);

% b. Sum of second row of B
part_b = sum(B(2, :));

% c. Multiply 2nd col of B and 1st col of A element-wise
part_c = B(:, 2) .* A(:, 1);

% d. Max value of result from c
part_d = max(part_c);

% e. Divide 1st row of A by first 3 elements of 3rd col of B
% Note: A(1,:) is 1x3. B(1:3, 3) is 3x1. 
% We must transpose B's slice to match dimensions.
vec_e = A(1, :) ./ B(1:3, 3)'; 
part_e = sum(vec_e);

disp(['Sum (Part b): ', num2str(part_b)]);
disp(['Max (Part d): ', num2str(part_d)]);
disp(['Sum (Part e): ', num2str(part_e)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 11}
Create a three-dimensional array D whose three "layers" are matrices A, B, and C. Use MATLAB to find the largest element in each layer of D and the largest element in D.

\begin{lstlisting}
A = [3, -2, 1; 6, 8, -5; 7, 9, 10];
B = [6, 9, -4; 7, 5, 3; -8, 2, 1];
C = [-7, -5, 2; 10, 6, 1; 3, -9, 8];

% Create 3D array D
D(:, :, 1) = A;
D(:, :, 2) = B;
D(:, :, 3) = C;

% Largest element in each layer
max_layer_1 = max(max(D(:, :, 1)));
max_layer_2 = max(max(D(:, :, 2)));
max_layer_3 = max(max(D(:, :, 3)));

% Largest element in D
max_total = max(D(:));

disp(['Max Total: ', num2str(max_total)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 15}
Given matrices A, B, and C, verify the associative and commutative laws for addition.

\begin{lstlisting}
A = [-7, 11; 4, 9];
B = [4, -5; 12, -2];
C = [-3, -9; 7, 8];

% a. A + B + C
res_a = A + B + C;

% b. A - B + C
res_b = A - B + C;

% c. Verify Associative Law: (A+B)+C = A+(B+C)
check_assoc = isequal((A+B)+C, A+(B+C));

% d. Verify Commutative Law: A+B+C = B+C+A = A+C+B
term1 = A + B + C;
term2 = B + C + A;
term3 = A + C + B;
check_comm = isequal(term1, term2) && isequal(term2, term3);

if check_assoc && check_comm
    disp('Laws Verified');
else
    disp('Verification Failed');
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 19}
Plot the function $f(x)=\frac{4 \cos x}{x+e^{-0.75x}}$ over the interval $-2\le x\le16$.

\begin{lstlisting}
x = -2 : 0.05 : 16; % Smooth interval
f = (4 .* cos(x)) ./ (x + exp(-0.75 .* x));

plot(x, f);
title('Plot of f(x)');
xlabel('x');
ylabel('f(x)');
grid on;
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 22}
A ship travels on a straight line course described by $y=(200-5x)/6$. The ship starts when $x=-20$ and ends when $x=40$. Calculate the distance at closest approach to a lighthouse located at the origin (0,0) without using a plot.

\begin{lstlisting}
% Define path range
x = -20 : 0.01 : 40;
y = (200 - 5 .* x) ./ 6;

% Distance formula d = sqrt(x^2 + y^2)
distances = sqrt(x.^2 + y.^2);

% Find minimum distance
min_dist = min(distances);

disp(['Closest approach distance: ', num2str(min_dist), ' km']);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 23}
Calculate work done $W=FD$ for five segments of a path given force and distance data. Find (a) work for each segment and (b) total work.

\begin{lstlisting}
% Data vectors
Force = [400, 550, 700, 500, 600]; % Newtons
Distance = [3, 0.5, 0.75, 1.5, 5]; % Meters

% a. Work per segment (Element-wise multiplication)
Work_segments = Force .* Distance;

% b. Total work
Work_total = sum(Work_segments);

disp('Work per segment (J):');
disp(Work_segments);
disp(['Total Work (J): ', num2str(Work_total)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 27}
Calculate compression $x$ and potential energy $PE = \frac{1}{2}kx^2$ for five springs given Force $F=kx$ and spring constant $k$.

\begin{lstlisting}
% Data
F = [11, 7, 8, 10, 9];          % Force (N)
k = [1000, 600, 900, 1300, 700]; % Constant (N/m)

% a. Compression x = F / k
x = F ./ k;

% b. Potential Energy PE = 0.5 * k * x^2
PE = 0.5 .* k .* (x.^2);

% Display results table
disp(table(F', k', x', PE', 'VariableNames', {'Force','k','Compression','PE'}));
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 41}
Solve the following system using the left-division method.
\[
\begin{aligned}
6x - 3y + 4z &= 41 \\
12x + 5y - 7z &= -26 \\
-5x + 2y - 6z &= 16
\end{aligned}
\]

\begin{lstlisting}
% Coefficient Matrix A
A = [ 6, -3,  4;
     12,  5, -7;
     -5,  2, -6];

% Constant Vector B
B = [41; -26; 16];

% Solve for X = [x; y; z] using left division
Solution = A \ B;

disp('Solution [x; y; z]:');
disp(Solution);
\end{lstlisting}


%===================================
% TUTORIAL 3 SECTION
%===================================
\newpage
\label{tut3}
\mypart{Tutorial 03: Functions}

\input{sections/tut3_summary}
\vspace{1cm}
\hrule
\vspace{0.5cm}
\section*{Tutorial Problems}

\myproblem{Problem 10}
An object thrown vertically with a speed $v_0$ reaches a height $h$ at time $t$, where $h=v_{0}t-\frac{1}{2}gt^{2}$. Write and test a function that computes the time $t$ required to reach a specified height $h$, for a given value of $v_0$. The function's inputs should be $h, v_0, g$. Test for $h=100$ m, $v_{0}=50$ m/s, $g=9.81 m/s^2$.

\begin{lstlisting}
% --- Main Script ---
h = 100; v0 = 50; g = 9.81;

% Call the function
t_solutions = compute_time(h, v0, g);

disp('Times to reach 100m (seconds):');
disp(t_solutions);
% Interpretation: The object reaches 100m twice.
% Once on the way up, and once on the way down.

% --- Function Definition ---
function t = compute_time(h, v0, g)
    % Solves 0.5*g*t^2 - v0*t + h = 0
    % Using quadratic formula: ax^2 + bx + c = 0
    % a = 0.5*g, b = -v0, c = h
    
    roots_vec = roots([0.5*g, -v0, h]);
    t = roots_vec;
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 17}
The volume and paper surface area $A$ of a conical paper cup are given by $V=\frac{1}{3}\pi r^{2}h$ and $A=\pi r\sqrt{r^{2}+h^{2}}$.
\begin{itemize}
    \item[a.] Eliminate $h$ to obtain $A$ as a function of $r$ and $V$.
    \item[b.] Create a function for $A$ and use \texttt{fminbnd} to find $r$ that minimizes $A$ for $V=10$ in$^3$.
\end{itemize}

\begin{lstlisting}
% --- Main Script ---
global V
V = 10; % Volume constraint

% Minimize Area function between r=0.1 and r=10
[r_min, A_min] = fminbnd(@cone_area, 0.1, 10);

% Calculate corresponding h
h_min = 3 * V / (pi * r_min^2);

disp(['Optimal r: ', num2str(r_min)]);
disp(['Optimal h: ', num2str(h_min)]);
disp(['Minimum Area: ', num2str(A_min)]);

% --- Function Definition ---
function A = cone_area(r)
    global V
    % Eliminate h: h = 3V / (pi*r^2)
    h = 3 * V ./ (pi .* r.^2);
    % Substitute into A
    A = pi .* r .* sqrt(r.^2 + h.^2);
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 18}
A torus with inner radius $a$ and outer radius $b$ has volume $V=\frac{1}{4}\pi^{2}(a+b)(b-a)^{2}$ and surface area $A=\pi^{2}(b^{2}-a^{2})$.
\begin{itemize}
    \item[a.] Create a function for $V$ and $A$.
    \item[b.] Plot $A$ vs $a$ for $0.25 \le a \le 4$ given $b = a + 2$.
\end{itemize}

\begin{lstlisting}
% --- Main Script ---
a = 0.25 : 0.01 : 4;
b = a + 2; % Constraint

% Compute A and V using arrays
[V, A] = torus_calc(a, b);

plot(a, A);
title('Torus Surface Area vs Inner Radius a');
xlabel('a (inches)');
ylabel('Surface Area A');
grid on;

% --- Function Definition ---
function [V, A] = torus_calc(a, b)
    V = 0.25 * pi^2 .* (a + b) .* (b - a).^2;
    A = pi^2 .* (b.^2 - a.^2);
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 21}
Create a function that will plot the entire ellipse $\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1$, given inputs $a$ and $b$. Test for $a=1, b=2$.

\begin{lstlisting}
% --- Main Script ---
plot_ellipse(1, 2);

% --- Function Definition ---
function plot_ellipse(a, b)
    % Use parametric equations for full ellipse
    t = linspace(0, 2*pi, 100);
    x = a * cos(t);
    y = b * sin(t);
    
    figure;
    plot(x, y);
    title(['Ellipse: a=', num2str(a), ', b=', num2str(b)]);
    axis equal;
    grid on;
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 25}
Create an anonymous function for $30x^{2}-300x+4$.
\begin{itemize}
    \item[a.] Plot to approximate minimum.
    \item[b.] Use \texttt{fminbnd} to determine the precise minimum location.
\end{itemize}

\begin{lstlisting}
f = @(x) 30*x.^2 - 300*x + 4;

% a. Plotting
x_plot = -5:0.1:15;
plot(x_plot, f(x_plot));
grid on; title('Plot of 30x^2 - 300x + 4');

% b. Finding minimum
[x_min, val_min] = fminbnd(f, 0, 10);
disp(['Minimum occurs at x = ', num2str(x_min)]);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 31}
Estimate the three coefficients $a, b, c$ of the logistic growth model $y(t)=\frac{c}{1+ae^{-bt}}$ using the provided data and \texttt{fminsearch}.

\begin{lstlisting}
% Data
t = 0:15;
y_data = [13, 16, 20, 25, 31, 39, 45, 49, 55, 63, 69, 77, 82, 86, 89, 92];

% Model Function: y = c / (1 + a*exp(-b*t))
model_fun = @(p, t) p(3) ./ (1 + p(1) * exp(-p(2) * t));

% Error Function (Sum of Squared Errors)
err_fun = @(p) sum((y_data - model_fun(p, t)).^2);

% Initial Guess: c around 100 (max percent), a and b generic guesses
guess = [10, 0.5, 100]; 

% Optimization
p_opt = fminsearch(err_fun, guess);
a_est = p_opt(1); b_est = p_opt(2); c_est = p_opt(3);

% Plotting results
t_smooth = 0:0.1:15;
y_fit = model_fun(p_opt, t_smooth);

plot(t, y_data, 'ko', t_smooth, y_fit, 'b-');
legend('Data', 'Logistic Fit');
title('Logistic Growth Regression');
disp(['Estimated: a=',num2str(a_est),', b=',num2str(b_est),', c=',num2str(c_est)]);
\end{lstlisting}

%===================================
% TUTORIAL 4 SECTION
%===================================
\newpage
\label{tut4}
\mypart{Tutorial 04: Programming with MATLAB}
\input{sections/tut4_summary}

\vspace{1cm}
\hrule
\vspace{0.5cm}	
\section*{Tutorial Problems}

\myproblem{Problem 2}
The roots of $ax^{2}+bx+c=0$ are $x=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a}$. Write a program to compute both roots, identifying real and imaginary parts. Test for cases: (1) $2,10,12$ (2) $3,24,48$ (3) $4,24,100$.

\begin{lstlisting}
% Define test cases
cases = [2, 10, 12; 
         3, 24, 48; 
         4, 24, 100];

for i = 1:size(cases, 1)
    a = cases(i, 1); b = cases(i, 2); c = cases(i, 3);
    
    disc = b^2 - 4*a*c;
    
    if disc > 0
        x1 = (-b + sqrt(disc))/(2*a);
        x2 = (-b - sqrt(disc))/(2*a);
        type = 'Real and distinct';
    elseif disc == 0
        x1 = -b/(2*a);
        x2 = x1;
        type = 'Real and repeated';
    else
        real_part = -b/(2*a);
        imag_part = sqrt(abs(disc))/(2*a);
        x1 = complex(real_part, imag_part);
        x2 = complex(real_part, -imag_part);
        type = 'Complex conjugates';
    end
    
    disp(['Case ', num2str(i), ': ', type]);
    disp(['Roots: ', num2str(x1), ' and ', num2str(x2)]);
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 9}
Determine how many days the price of stock A was below the price of stock B given arrays.

\begin{lstlisting}
price_A = [19, 18, 22, 21, 25, 19, 17, 21, 27, 29];
price_B = [22, 17, 20, 23, 24, 18, 16, 25, 28, 27];

% Logical comparison
days_below = price_A < price_B;

% Count true values
num_days = sum(days_below);

disp(['Days A was below B: ', num2str(num_days)]);
\end{lstlisting}

%-----------------------------------    
\myproblem{Problem 16}
In this problem, we write a MATLAB script using conditional statements to evaluate the piecewise-defined function
\[
y(x)=
\begin{cases}
e^{x}+1, & x<-1,\\[4pt]
2+\cos(\pi x), & -1\le x<5,\\[4pt]
10(x-5)+1, & x\ge 5.
\end{cases}
\]
Using the script, we evaluate $y$ at $x=-5$, $x=3$, and $x=15$, and then verify the results by hand.

\noindent\textbf{By-hand check:}
\[
\begin{aligned}
y(-5) &= e^{-5}+1 \approx 1.0067379,\\
y(3)  &= 2+\cos(3\pi)=2-1=1,\\
y(15) &= 10(15-5)+1=101.
\end{aligned}
\]

\begin{lstlisting}
% --- Main Script (Problem 16) ---
xs = [-5, 3, 15];

for k = 1:length(xs)
    x = xs(k);

    if x < -1
        y = exp(x) + 1;
    elseif x >= -1 && x < 5
        y = 2 + cos(pi*x);
    else % x >= 5
        y = 10*(x - 5) + 1;
    end

    disp(['x = ', num2str(x), ' -> y = ', num2str(y)]);
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 21}
In this problem, we create a MATLAB function \texttt{fxy(x,y)} to evaluate a piecewise-defined function $f(x,y)$ based on the signs of $x$ and $y$. The function is defined as:
\[
f(x,y)=
\begin{cases}
x+y, & x\ge 0,\; y\ge 0,\\
x-y, & x\ge 0,\; y<0,\\
-x^2y, & x<0,\; y\ge 0,\\
-x^2y^2, & x<0,\; y<0.
\end{cases}
\]
To verify correctness, we evaluate the function at four test points: $(1,1)$, $(1,-1)$, $(-1,1)$, and $(-1,-1)$, which cover all four regions.

\begin{lstlisting}
% --- Main Script ---
disp(['f(1,1) = ', num2str(fxy(1,1))]);
disp(['f(1,-1) = ', num2str(fxy(1,-1))]);
disp(['f(-1,1) = ', num2str(fxy(-1,1))]);
disp(['f(-1,-1) = ', num2str(fxy(-1,-1))]);

% --- Function Definition ---
function val = fxy(x, y)
    if x >= 0 && y >= 0
        val = x + y;
    elseif x >= 0 && y < 0
        val = x - y;
    elseif x < 0 && y >= 0
        val = -x^2 * y;
    else % x < 0 and y < 0
        val = -x^2 * y^2;
    end
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 28}
Consider the matrix
\[
A=
\begin{bmatrix}
3 & 5 & -4\\
-8 & -1 & 33\\
-17 & 6 & -9
\end{bmatrix}.
\]
We compute an array $B$ by applying the following rule to each element of $A$:
\[
B_{ij}=
\begin{cases}
\ln(A_{ij})+20, & A_{ij}\ge 1,\\
A_{ij}, & A_{ij}<1.
\end{cases}
\]
This is done in two ways: (a) using a \texttt{for} loop with conditional statements, and (b) using a logical mask.

\noindent\textbf{Expected result (approx.):}
\[
B\approx
\begin{bmatrix}
21.0986 & 21.6094 & -4\\
-8 & -1 & 23.4965\\
-17 & 21.7918 & -9
\end{bmatrix}.
\]

\begin{lstlisting}
% --- Main Script (Problem 28) ---
A = [  3   5  -4;
      -8  -1  33;
     -17   6  -9];

%% (a) Using a for loop + conditionals
B1 = A;  % start by copying A
[m,n] = size(A);

for i = 1:m
    for j = 1:n
        if A(i,j) >= 1
            B1(i,j) = log(A(i,j)) + 20;  % natural log + 20
        end
    end
end

%% (b) Using a logical mask
B2 = A;               % start by copying A
mask = (A >= 1);      % logical array (true where condition holds)
B2(mask) = log(A(mask)) + 20;

%% Display results
disp('A =');  disp(A);
disp('B1 (loop) ='); disp(B1);
disp('B2 (mask) ='); disp(B2);

% Check they match (should be all zeros)
disp('Max difference between B1 and B2:');
disp(max(abs(B1(:) - B2(:))));
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 40}
A weight $W$ is supported by two cables anchored a distance $D$ apart. The left cable length $L_{AB}$ is known, while the right cable length $L_{AC}$ must be selected. For static equilibrium, the horizontal and vertical force sums at point $B$ must be zero, giving
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{images/figure_p40.png}
    \caption{Cable system showing weight $W$ supported by two cables with lengths $L_{AB}$ and $L_{AC}$, anchored at distance $D$ apart.}
    \label{fig:p40}
\end{figure}
\[
-T_{AB}\cos\theta + T_{AC}\cos\phi = 0,
\qquad
T_{AB}\sin\theta + T_{AC}\sin\phi = W.
\]
The angles $\theta$ and $\phi$ depend on the cable lengths. Using triangle geometry:
\[
\theta=\cos^{-1}\!\left(\frac{D^2+L_{AB}^2-L_{AC}^2}{2DL_{AB}}\right),
\qquad
\phi=\sin^{-1}\!\left(\frac{L_{AB}\sin\theta}{L_{AC}}\right).
\]
Given $D=6~\text{ft}$, $L_{AB}=3~\text{ft}$, and $W=2000~\text{lb}$, we use a \texttt{while} loop in MATLAB to find $L_{AC,\min}$ (the shortest $L_{AC}$ such that neither $T_{AB}$ nor $T_{AC}$ exceeds $2000~\text{lb}$). Then we plot $T_{AB}$ and $T_{AC}$ versus $L_{AC}$ for $L_{AC,\min}\le L_{AC}\le 6.7$.

\begin{lstlisting}
% --- Main Script (Problem 40) ---
clear; clc; close all;

D   = 6;        % ft
LAB = 3;        % ft
W   = 2000;     % lb
LAC_max = 6.7;  % ft (given)

% Step size for searching LAC_min
dL = 1e-3;

% Start from just above the triangle lower bound |D-LAB| = 3
LAC = abs(D - LAB) + 1e-4;

TAB = inf;  TAC = inf;

% ---- WHILE LOOP to find LAC_min ----
while (TAB > W) || (TAC > W)
    % Compute angles (radians)
    theta = acos((D^2 + LAB^2 - LAC^2)/(2*D*LAB));
    phi   = asin((LAB*sin(theta))/LAC);

    % Solve equilibrium for [TAB; TAC]
    A = [-cos(theta),  cos(phi);
          sin(theta),  sin(phi)];
    b = [0; W];

    T = A\b;        % T(1)=TAB, T(2)=TAC
    TAB = T(1);
    TAC = T(2);

    % Increase LAC until both tensions are <= W
    if (TAB > W) || (TAC > W)
        LAC = LAC + dL;
    end

    % Safety stop (should not happen for this problem)
    if LAC > LAC_max
        error('No feasible LAC found up to LAC_max.');
    end
end

LAC_min = LAC;
fprintf('LAC_min = %.4f ft\n', LAC_min);
fprintf('TAB = %.2f lb, TAC = %.2f lb\n', TAB, TAC);

% ---- Compute tensions for plotting from LAC_min to 6.7 ----
Lvec = LAC_min:dL:LAC_max;
TABv = zeros(size(Lvec));
TACv = zeros(size(Lvec));

for k = 1:length(Lvec)
    LAC = Lvec(k);

    theta = acos((D^2 + LAB^2 - LAC^2)/(2*D*LAB));
    phi   = asin((LAB*sin(theta))/LAC);

    A = [-cos(theta),  cos(phi);
          sin(theta),  sin(phi)];
    b = [0; W];

    T = A\b;
    TABv(k) = T(1);
    TACv(k) = T(2);
end

% ---- Plot ----
figure;
plot(Lvec, TABv, 'LineWidth', 1.5); hold on;
plot(Lvec, TACv, 'LineWidth', 1.5);
yline(W, '--', 'LineWidth', 1.2);  % limit line at 2000 lb
grid on;
xlabel('L_{AC} (ft)');
ylabel('Tension (lb)');
title('T_{AB} and T_{AC} vs. L_{AC}');
legend('T_{AB}', 'T_{AC}', 'W = 2000 lb', 'Location', 'best');
\end{lstlisting}

\myproblem{Problem 42}
The circuit in Fig.~P42 is governed by the five equations
\[
-v_1+R_1 i_1+R_4 i_4=0,\qquad
-R_4 i_4+R_2 i_2+R_5 i_5=0,\qquad
-R_5 i_5+R_3 i_3+v_2=0,
\]
\[
i_1=i_2+i_4,\qquad i_2=i_3+i_5.
\]
Given $R_1=5~\text{k}\Omega,\;R_2=100~\text{k}\Omega,\;R_3=200~\text{k}\Omega,\;R_4=150~\text{k}\Omega,\;R_5=250~\text{k}\Omega$ and $v_1=100~\text{V}$, each resistor is rated for a current magnitude no larger than $I_{\max}=1~\text{mA}$.  

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{images/figure_p42.png}
    \caption{Circuit diagram for Problem 42.}
    \label{fig:p42}
\end{figure}

\textbf{(a)} We determine the allowable range of \emph{positive} values of $v_3$ such that

\[
|i_1|,|i_2|,|i_3|,|i_4|,|i_5|\le I_{\max}.
\]

\textbf{Result for the given numbers (approx.):}
\[
\boxed{31.67~\text{V}\ \le\ v_2\ \le\ 742.31~\text{V}}
\]
(the lower bound is set by $|i_1|\le 1$ mA and the upper bound is set by $|i_5|\le 1$ mA).

\textbf{(b)} To study the effect of $R_3$, we vary $R_3$ from $150$ to $250$ k$\Omega$ and compute the corresponding upper allowable limit on $v_2$, then plot $v_{2,\max}$ versus $R_3$.

\begin{lstlisting}
% --- Main Script (Problem 42) ---
clear; clc; close all;

% Given values (kOhm -> Ohm)
R1 = 5e3;    R2 = 100e3;  R3 = 200e3;  R4 = 150e3;  R5 = 250e3;
v1 = 100;            % V
Imax = 1e-3;          % A

% Helper function: compute allowable v2 interval for a given R3
% Returns [v2min, v2max] for v2 > 0, based on |currents| <= Imax
allowable_v2 = @(R3val) local_allowable_v2(R1,R2,R3val,R4,R5,v1,Imax);

%% (a) Allowable range for the given R3
[v2min, v2max] = allowable_v2(R3);
fprintf('(a) Allowable v2 range: %.4f V <= v2 <= %.4f V\n', v2min, v2max);

%% (b) Vary R3 from 150 to 250 kOhm, plot the upper allowable limit v2max
R3vec = linspace(150e3, 250e3, 200);
v2max_vec = zeros(size(R3vec));

for k = 1:length(R3vec)
    [~, v2max_vec(k)] = allowable_v2(R3vec(k));
end

figure;
plot(R3vec/1e3, v2max_vec, 'LineWidth', 1.5);
grid on;
xlabel('R_3 (k\Omega)');
ylabel('Upper allowable v_2 (V)');
title('Allowable upper limit of v_2 vs. R_3');

%% -------- Local function (kept at end of script) --------
function [v2min, v2max] = local_allowable_v2(R1,R2,R3,R4,R5,v1,Imax)
    % Unknowns: i1,i2,i3,i4,i5
    % Build linear system A*i = b, where b depends on v2.
    %
    % Equations:
    % -v1 + R1 i1 + R4 i4 = 0
    % -R4 i4 + R2 i2 + R5 i5 = 0
    % -R5 i5 + R3 i3 + v2 = 0
    % i1 - i2 - i4 = 0
    % i2 - i3 - i5 = 0

    A = [ R1,   0,   0,  R4,   0;
           0,  R2,   0, -R4,  R5;
           0,   0,  R3,   0, -R5;
           1,  -1,   0,  -1,   0;
           0,   1,  -1,   0,  -1];

    % Solve i(v2) = a + b*v2 by two solves: v2=0 and v2=1
    b0 = [v1; 0; 0; 0; 0];     % v2 = 0 -> third equation RHS is 0
    b1 = [v1; 0; -1; 0; 0];    % v2 = 1 -> third equation becomes R3*i3 - R5*i5 = -1

    i0 = A\b0;                 % currents when v2 = 0
    i1 = A\b1;                 % currents when v2 = 1
    slope = i1 - i0;           % di/dv2
    offset = i0;               % i(v2)=offset + slope*v2

    % For each current: |offset + slope*v2| <= Imax gives an interval in v2
    v_low = -inf;
    v_high = inf;

    for k = 1:5
        a = offset(k);
        m = slope(k);

        if abs(m) < 1e-15
            % current independent of v2
            if abs(a) > Imax
                v_low = 1; v_high = 0; % empty interval
                break;
            end
        else
            % Solve -Imax <= a + m*v2 <= Imax
            v1k = (-Imax - a)/m;
            v2k = ( Imax - a)/m;
            lo = min(v1k, v2k);
            hi = max(v1k, v2k);

            v_low = max(v_low, lo);
            v_high = min(v_high, hi);
        end
    end

    % Also require v2 > 0
    v_low = max(v_low, 0);

    v2min = v_low;
    v2max = v_high;
end
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 44}
We are given the MATLAB script:
\begin{lstlisting}
k = 1; b = -2; x = -1; y = -2;
while k <= 3
    k, b, x, y
    y = x^2 - 3;
    if y < b
        b = y;
    end
    x = x + 1;
    k = k + 1;
end
\end{lstlisting}

The line \texttt{k, b, x, y} displays the values \emph{immediately after entering the while-loop body}, i.e., before updating $y$, possibly updating $b$, and incrementing $x$ and $k$. Since the loop condition is $k \le 3$, the loop executes exactly three times.

\begin{center}
\begin{tabular}{lcccc}
\hline
Pass & $k$ & $b$ & $x$ & $y$ \\
\hline
First  & 1 & $-2$ & $-1$ & $-2$ \\
Second & 2 & $-2$ & 0   & $-2$ \\
Third  & 3 & $-3$ & 1   & $-3$ \\
\hline
\end{tabular}
\end{center}

\noindent\textbf{Quick check (updates each pass):}
\[
\begin{aligned}
\text{Pass 1: } & y=(-1)^2-3=-2,\; b\text{ stays }-2,\; x\to 0,\; k\to 2,\\
\text{Pass 2: } & y=(0)^2-3=-3,\; b\to -3,\; x\to 1,\; k\to 3,\\
\text{Pass 3: } & y=(1)^2-3=-2,\; b\text{ stays }-3,\; x\to 2,\; k\to 4\ (\text{stop}).
\end{aligned}
\]

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{images/figure44.png}
    \caption{Figure for Problem 44.}
    \label{fig:44}
\end{figure}

%===================================
% TUTORIAL 9 SECTION
%===================================
\newpage
\label{tut9}
\mypart{Tutorial 09: Numerical Methods}

\input{sections/tut5_summary}

\vspace{1cm}
\hrule
\vspace{0.5cm}	
\section*{Tutorial Problems}

\myproblem{Problem 5}
Acceleration $a(t)=5t \sin(8t)$. Compute velocity at $t=20$ if $v(0)=0$.

\begin{lstlisting}
% v(t) = integral of a(t) from 0 to 20
a_fun = @(t) 5 .* t .* sin(8 .* t);
v_20 = integral(a_fun, 0, 20);

disp(['Velocity at t=20: ', num2str(v_20), ' m/s']);
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 10}
Rocket equation: $m(t)\frac{dv}{dt}=T-m(t)g$. Calculate velocity at burnout ($t=40$). $T=48000, m_0=2200, r=0.8, g=9.81$.

\begin{lstlisting}
T = 48000; m0 = 2200; r = 0.8; g = 9.81; b = 40;

% ODE: dv/dt = T/m(t) - g
% m(t) = m0 * (1 - r*t/b)
dvdt = @(t, v) (T ./ (m0 * (1 - r*t/b))) - g;

[t_sol, v_sol] = ode45(dvdt, [0, b], 0);

disp(['Velocity at burnout: ', num2str(v_sol(end)), ' m/s']);
plot(t_sol, v_sol); title('Rocket Velocity'); xlabel('t'); ylabel('v');
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 21}
Use the \texttt{diff} function to estimate the derivative of $y=e^{-2x}\frac{\sin(4x)}{x^{2}+3}$ at $x=0.6$.

\begin{lstlisting}
% Define x with fine resolution around 0.6
dx = 0.001;
x = 0 : dx : 1;
y = exp(-2*x) .* sin(4*x) ./ (x.^2 + 3);

% Calculate approximate derivative dy/dx
% diff(y) is difference between adjacent elements
% dividing by dx gives the slope
dydx = diff(y) ./ dx;

% Find index corresponding to x = 0.6
% Note: diff result is 1 element shorter than x
x_diff = x(1:end-1); 
[~, idx] = min(abs(x_diff - 0.6));

deriv_val = dydx(idx);

disp(['Approximate derivative at x=0.6: ', num2str(deriv_val)]);

% Analytical check (optional, for verification)
% y' via Chain/Quotient Rule
x0 = 0.6;
% ... (manual calc omitted for brevity)
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 29}
Spherical tank draining. $\pi(2rh-h^{2})\frac{dh}{dt}=-C_{d}A\sqrt{2gh}$.
Radius $r=3$, drain radius 2cm ($0.02$m), $C_d=0.5$, $h(0)=5$. Estimate empty time.

\begin{lstlisting}
r_tank = 3;
r_drain = 0.02;
A_drain = pi * r_drain^2;
Cd = 0.5; g = 9.81;

% ODE: dh/dt = - (Cd * A * sqrt(2gh)) / (pi * (2rh - h^2))
dhdt = @(t, h) -(Cd * A_drain * sqrt(2*g*h)) ./ (pi * (2*r_tank*h - h.^2));

% Integrate until h is near 0 (event function typically used, or guess time)
% Using ode45 with events to stop at h=0
options = odeset('Events', @stop_event);
[t, h] = ode45(dhdt, [0, 50000], 5, options);

disp(['Time to empty: ', num2str(t(end)/3600), ' hours']);
plot(t, h); title('Tank Draining');

% Event function definition
function [value, isterminal, direction] = stop_event(t, h)
    value = h - 0.01; % Stop when height is 1cm
    isterminal = 1;
    direction = 0;
end
\end{lstlisting}
%-----------------------------------

\myproblem{Problem 32}
The motion of a mass is described by $3\ddot{y}+18\dot{y}+102y=f(t)$ with $f(t)=0$ for $t < 0$ and $f(t)=10$ for $t \ge 0$.
\begin{enumerate}
    \item[a.] Plot $y(t)$ for $y(0)=\dot{y}(0)=0$ 
        \item[b.] Plot $y(t)$ for $y(0)=0, \dot{y}(0)=10$. Discuss the effect of nonzero initial velocity.
\end{enumerate}

\begin{lstlisting}
% Rewrite as: y_ddot = (1/3)*(f(t) - 18*y_dot - 102*y)
% State x1 = y, x2 = y_dot
% dx1 = x2
% dx2 = (1/3)*(f - 18*x2 - 102*x1)

t_span = [0, 5];
f_val = 10; 

% a. Zero Initial Conditions
IC_a = [0; 0];
ode_a = @(t, x) [x(2); (1/3)*(f_val - 18*x(2) - 102*x(1))];
[t_a, y_a] = ode45(ode_a, t_span, IC_a);

% b. Non-zero Initial Velocity (y(0)=0, y_dot(0)=10)
IC_b = [0; 10];
ode_b = @(t, x) [x(2); (1/3)*(f_val - 18*x(2) - 102*x(1))];
[t_b, y_b] = ode45(ode_b, t_span, IC_b);

% Plotting
figure;
plot(t_a, y_a(:,1), 'b-', 'LineWidth', 1.5); hold on;
plot(t_b, y_b(:,1), 'r--', 'LineWidth', 1.5);
legend('Case A: Zero ICs', 'Case B: Init Vel = 10');
title('Response of Mass-Spring-Damper');
xlabel('Time (s)'); ylabel('Displacement y(t)');
grid on;
\end{lstlisting}

%-----------------------------------
\myproblem{Problem 44}
State model with $m=1, c=2, k=5$: 
\[
\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = 
\begin{bmatrix} 0 & 1 \\ -5 & -2 \end{bmatrix}
\begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + 
\begin{bmatrix} 0 \\ 1 \end{bmatrix} f(t)
\]
\begin{enumerate}
    \item[a.] Use the \texttt{initial} function to plot position $x_1$ if $x(0)=[5; 3]$.
    \item[b.] Use the \texttt{step} function to plot the response for step input of magnitude 10.
\end{enumerate}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/figure9.png}
\end{figure}

\begin{lstlisting}
% Define Matrices
A = [0, 1; -5, -2];
B = [0; 1];
C = [1, 0]; % Output y = x1 (Position)
D = 0;

% Create State Space System (requires Control System Toolbox)
sys = ss(A, B, C, D);

% a. Initial Response (Free response to initial conditions)
x0 = [5; 3];
figure;
subplot(2,1,1);
initial(sys, x0); 
title('a. Response to Initial Conditions x0=[5; 3]');
grid on;

% b. Step Response (Step magnitude 10)
% The standard step(sys) assumes input is 1. 
% For magnitude 10, we scale the system or the input.
sys_scaled = sys * 10; % Scale input channel by 10

subplot(2,1,2);
step(sys_scaled);
title('b. Step Response (Input Magnitude 10)');
grid on;
\end{lstlisting}



%-----------------------------------
\myproblem{Problem 45}
Equation $5\ddot{y}+2\dot{y}+10y=f(t)$.
\begin{itemize}
    \item[a.] Free response: $y(0)=10, \dot{y}(0)=-5$.
    \item[b.] Step response: Zero ICs, unit step input.
    \item[c.] Total response superposition.
\end{itemize}

\begin{lstlisting}
% State Space: x1 = y, x2 = y_dot
% y_ddot = (f - 2y_dot - 10y)/5
% dx1 = x2
% dx2 = 0.2f - 0.4x2 - 2x1

% a. Free Response (f=0)
ode_free = @(t, x) [x(2); -0.4*x(2) - 2*x(1)];
[t_free, x_free] = ode45(ode_free, [0, 15], [10; -5]);

% b. Step Response (f=1, IC=0)
ode_step = @(t, x) [x(2); 0.2*1 - 0.4*x(2) - 2*x(1)];
[t_step, x_step] = ode45(ode_step, [0, 15], [0; 0]);

% c. Total Response (f=1, IC=[10, -5])
ode_total = @(t, x) [x(2); 0.2*1 - 0.4*x(2) - 2*x(1)];
[t_tot, x_tot] = ode45(ode_total, [0, 15], [10; -5]);

% Plotting
figure;
plot(t_free, x_free(:,1), '--', 'DisplayName', 'Free'); hold on;
plot(t_step, x_step(:,1), ':', 'DisplayName', 'Step');
plot(t_tot, x_tot(:,1), 'k-', 'LineWidth', 1.5, 'DisplayName', 'Total');
legend; title('Superposition of Responses');
\end{lstlisting}

%===================================
% TUTORIAL 10 SECTION
%===================================
\newpage
\label{tut10}
\mypart{Tutorial 10: Simulink}

\input{sections/tut6_summary}

\vspace{1cm}
\hrule
\vspace{0.5cm}

\end{document}