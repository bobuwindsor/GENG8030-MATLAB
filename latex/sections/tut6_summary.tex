%===================================
% KEY SUMMARY â€” Tutorial 10 Concepts
%===================================

\section*{Key Concepts and Common Pitfalls (Tutorial 10 Summary)}

\subsection*{1. Simulink vs.\ MATLAB ODE Solvers}

Simulink provides a block-diagram environment for simulating dynamic systems. The same problems can be solved programmatically in MATLAB using \texttt{ode45}. Key equivalences:

\begin{itemize}
    \item \textbf{Integrator block} $\Leftrightarrow$ state variable (integrate $\dot{x}$ to get $x$)
    \item \textbf{Gain block} $\Leftrightarrow$ scalar multiplication in the ODE function
    \item \textbf{Sum block} $\Leftrightarrow$ addition inside the ODE function
    \item \textbf{Fcn/Math block} $\Leftrightarrow$ nonlinear expression (e.g., \texttt{sin(x)}, \texttt{x\^{}3})
\end{itemize}

\subsection*{2. Converting to State-Variable Form}

Every $n$th-order ODE must be reduced to $n$ first-order equations before using \texttt{ode45}:
\begin{enumerate}
    \item Solve for the highest derivative.
    \item Let $x_1 = y,\; x_2 = \dot{y},\; \ldots,\; x_n = y^{(n-1)}$.
    \item Write $\dot{x}_1 = x_2,\; \dot{x}_2 = x_3,\; \ldots,\; \dot{x}_n = (\text{expression from step 1})$.
\end{enumerate}

\subsection*{3. Transfer Function Approach (Linear Systems)}

For linear systems with zero initial conditions, use the Control System Toolbox:
\begin{itemize}
    \item \texttt{tf(num, den)}: create a transfer function from coefficient vectors
    \item \texttt{lsim(sys, u, t)}: simulate response to an arbitrary input vector
    \item \texttt{series(sys1, sys2)}: cascade two transfer functions
\end{itemize}

\subsection*{4. Nonlinear Systems}

Nonlinear elements (e.g., $\sin x$, $x^3$, saturation) require \texttt{ode45} because the Control System Toolbox only supports LTI systems. Use \texttt{min}/\texttt{max} to implement Saturation blocks.

\vspace{1cm}
\hrule
\vspace{0.5cm}

\section*{Tutorial Problems}

%-----------------------------------
\myproblem{Problem 3}
Draw a simulation diagram for the equation:
\[3\dot{y} + 5\sin y = f(t)\]

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            oval/.style = {draw, rounded corners=2ex, minimum width=1.2cm, minimum height=0.6cm, align=center},
            block/.style = {draw, rectangle, minimum height=1.2cm, minimum width=1.2cm, align=center},
            sum/.style = {draw, circle, minimum size=0.8cm, inner sep=0pt},
            % Points RIGHT (forward path)
            gain/.style = {draw, isosceles triangle, isosceles triangle apex angle=60,
                           minimum height=1cm, minimum width=1cm,
                           shape border rotate=0, inner sep=2pt},
            % Points LEFT (feedback path)
            gainleft/.style = {draw, isosceles triangle, isosceles triangle apex angle=60,
                                minimum height=1cm, minimum width=1cm,
                                shape border rotate=180, inner sep=2pt}
        }
        % Input Block
        \node [oval, label=below:{$f(t)$}] (input) {1};
        % Summing Junction
        \node [sum, right=1.2cm of input] (sum) {};
        \node at ($(sum.west)+(0.18,0.12)$) {\tiny $+$};
        \node at ($(sum.south)+(0.12,0.18)$) {\tiny $-$};
        % Forward Path Blocks
        \node [gain, right=0.8cm of sum] (gain1) {$\frac{1}{3}$};
        \node [block, right=0.8cm of gain1] (int1) {\Large $\frac{1}{s}$};
        \node [block, right=0.8cm of int1] (int2) {\Large $\frac{1}{s}$};
        % Output Block
        \node [oval, label=below:{$y(t)$}, right=1.5cm of int2] (output) {1};
        % Feedback Path Blocks
        \node [block, below=1.5cm of int2] (sin) {sin};
        \node [gainleft, left=1cm of sin] (gain2) {5};
        % Forward Connections
        \draw [->] (input) -- (sum);
        \draw [->] (sum) -- (gain1);
        \draw [->] (gain1) -- (int1);
        \draw [->] (int1) -- (int2);
        % Tap junction and output connection
        \coordinate (tap) at ($(int2.east)!0.4!(output.west)$);
        \draw [->] (int2) -- (output);
        % Feedback Connections
        \draw [->] (tap) |- (sin);
        \draw [->] (sin) -- (gain2);
        \draw [->] (gain2) -| (sum.south);
        % Draw the tap dot
        \filldraw (tap) circle (1.5pt);
    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}

%-----------------------------------
\myproblem{Problem 5}
Draw a simulation diagram for the model:
\begin{align*}
\dot{x} &= -3x + 2y + f(t), \\
\dot{y} &= 4x - 5y
\end{align*}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            oval/.style     = {draw, rounded corners=2ex, minimum width=1.2cm, minimum height=0.6cm, align=center},
            block/.style    = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            sum/.style      = {draw, circle, minimum size=0.8cm, inner sep=0pt},
            gainR/.style    = {draw, isosceles triangle, isosceles triangle apex angle=60,
                               minimum height=0.9cm, shape border rotate=0, inner sep=2pt},
            gainL/.style    = {draw, isosceles triangle, isosceles triangle apex angle=60,
                               minimum height=0.9cm, shape border rotate=180, inner sep=2pt},
        }

        %--- Forward path nodes ---
        \node [oval, label=below:{$f(t)$}] (input) {1};
        \node [sum,  right=1.0cm of input]  (sum1)  {};
        \node [block, right=1.0cm of sum1, label=below:{$x$}] (int1) {$\dfrac{1}{s}$};
        \node [gainR, right=1.0cm of int1] (gain4) {4};
        \node [sum,  right=0.9cm of gain4] (sum2)  {};
        \node [block, right=1.0cm of sum2] (int2)  {$\dfrac{1}{s}$};
        \node [oval, label=below:{$y$}, right=1.0cm of int2] (output) {1};

        %--- Sum labels ---
        \node at ($(sum1.north)+(0.12,-0.20)$) {\tiny $+$};  % top
        \node at ($(sum1.west)+(0.18, -0.05)$)  {\tiny $+$};   % left side
        \node at ($(sum1.south)+(0.12,0.18)$) {\tiny $-$};   % bottom
        \node at ($(sum2.west)+(0.18,0.12)$)  {\tiny $+$};   % left side
        \node at ($(sum2.south)+(-0.05, 0.18)$) {\tiny $-$};   % bottom

        %--- Feedback gain nodes ---
        \node [gainL, above=1.2cm of gain4] (gain2) {2};
        \node [gainL, below=1.2cm of int1]  (gain3) {3};
        \node [gainL, below=1.2cm of int2]  (gain5) {5};

        %--- Tap coordinates ---
        \coordinate (tap1) at ($(int1.east)!0.5!(gain4.west)$);
        \coordinate (tap2) at ($(int2.east)!0.5!(output.west)$);

        %--- Forward connections ---
        \draw [->] (input) -- (sum1);
        \draw [->] (sum1)  -- (int1);
        \draw [->] (int1)  -- (gain4);
        \draw [->] (gain4) -- (sum2);
        \draw [->] (sum2)  -- (int2);
        \draw [->] (int2)  -- (output);

        %--- Tap dots ---
        \filldraw (tap1) circle (1.5pt);
        \filldraw (tap2) circle (1.5pt);

        %--- Upper feedback: tap2 -> gain2 -> sum1.north ---
        \draw [->] (tap2) |- (gain2.east);
        \draw [->] (gain2.west) -| (sum1.north);

        %--- Lower-left feedback: tap1 -> gain3 -> sum1.south ---
        \draw [->] (tap1) |- (gain3.east);
        \draw [->] (gain3.west) -| (sum1.south);

        %--- Lower-right feedback: tap2 -> gain5 -> sum2.south ---
        \draw [->] (tap2) |- (gain5.east);
        \draw [->] (gain5.west) -| (sum2.south);

    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}


%-----------------------------------
\myproblem{Problem 8}
Create a Simulink model to plot the solution for $0 \le t \le 6$:
\[10\ddot{y} = 7\sin 4t + 5\cos 3t, \qquad y(0)=3,\;\dot{y}(0)=2\]

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            waveblock/.style = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            block/.style     = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            outblock/.style  = {draw, rectangle, minimum height=0.8cm, minimum width=1.2cm, align=center},
            sum/.style       = {draw, circle, minimum size=0.8cm, inner sep=0pt},
            gainR/.style     = {draw, isosceles triangle, isosceles triangle apex angle=60,
                                minimum height=1.0cm, shape border rotate=0, inner sep=2pt},
        }

        % Wave source blocks
        \node [waveblock, label=below:{\small Sine Wave\newline Function}] (sine) {$\sim$};
        \node [waveblock, below=1.2cm of sine, label=below:{\small Cosine Wave\newline Function}] (cosine) {$\sim$};

        % Summing junction (vertically centered between sine and cosine)
        \node [sum, right=1.0cm of sine, yshift=-0.7cm] (sum1) {};
        \node at ($(sum1.north)+(0.12,-0.18)$) {\tiny $+$};
        \node at ($(sum1.south)+(0.12, 0.18)$) {\tiny $+$};

        % Forward path
        \node [gainR, right=0.8cm of sum1] (gain) {$\frac{1}{10}$};
        \node [block,  right=1.0cm of gain, label=below:{\small Integrator}]   (int1) {$\dfrac{1}{s}$};
        \node [block,  right=1.0cm of int1, label=below:{\small Integrator 1}] (int2) {$\dfrac{1}{s}$};
        \node [outblock, right=1.0cm of int2, label=below:{\small To Workspace}] (out) {\small simout};

        % Connections: sine -> sum (from top)
        \draw [->] (sine.east) -- ++(0.3,0) |- (sum1.north);

        % Connections: cosine -> sum (from bottom)
        \draw [->] (cosine.east) -- ++(0.3,0) |- (sum1.south);

        % Forward path connections
        \draw [->] (sum1)  -- (gain);
        \draw [->] (gain)  -- (int1);
        \draw [->] (int1)  -- (int2);
        \draw [->] (int2)  -- (out);

    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}

%-----------------------------------
\myproblem{Problem 10}
The equation $\dot{x} + x = \tan t$, $x(0) = 0$ has no analytical solution. The approximate solution (less accurate for large $t$) is:
\[x(t) = \tfrac{1}{3}t^3 - t^2 + 3t - 3 + 3\,e^{-t}\]
Compare the numerical and approximate solutions.

\begin{figure}[h!]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[>=Stealth]
        
        % --- Define Block Styles ---
        \tikzset{
            block/.style = {draw, rectangle, minimum height=0.9cm, minimum width=1.2cm, align=center},
            sum/.style = {draw, circle, minimum size=0.6cm, inner sep=0pt},
            % Regular polygon ensures the triangle strictly points right across all TikZ versions
            gain/.style = {draw, regular polygon, regular polygon sides=3, shape border rotate=-90, minimum width=1.0cm, inner sep=0pt},
            scope/.style = {draw, rectangle, minimum height=1.4cm, minimum width=1.2cm, fill=white}
        }

        % --- Top Row (Differential Equation Path) ---
        % Clock Icon
        \node [draw, circle, minimum size=0.6cm, inner sep=0pt] (clk) at (0,0) {};
        \draw (clk.center) -- ++(0,0.18) (clk.center) -- ++(0.18,0);
        
        \node [block] (tan) at (2,0) {tan};
        \node [sum] (sum1) at (3.5,0) {};
        \node [font=\tiny] at ($(sum1.west)+(0.15,0.1)$) {$+$};
        \node [font=\tiny] at ($(sum1.south)+(0.1,0.15)$) {$-$};
        
        \node [block] (int1) at (5.5,0) {$\frac{1}{s}$};

        % --- Middle Row (Polynomial Approximate Path) ---
        \node [block, align=center] (poly) at (3,-2) {\small $P(u)$ \\[-0.5ex] \small $O(P)=3$};
        \node [sum] (sum2) at (7,-2) {};
        \node [font=\tiny] at ($(sum2.west)+(0.15,0.1)$) {$+$};
        \node [font=\tiny] at ($(sum2.south)+(0.1,0.15)$) {$+$};

        % --- Bottom Row (Exponential Approximate Path) ---
        \node [gain] (gainNeg) at (2.5,-4) {-1};
        \node [block] (expu) at (4.5,-4) {$e^u$};
        \node [gain] (gain3) at (6.5,-4) {3};

        % --- Scope Component ---
        \node [scope] (scope) at (9,-1) {};
        % Inner screen rectangle
        \node [draw, rectangle, minimum height=0.8cm, minimum width=0.8cm] at (scope.center) {};
        % Define exact input ports
        \coordinate (scopeTop) at ($(scope.west) + (0, 0.3)$);
        \coordinate (scopeBot) at ($(scope.west) + (0, -0.3)$);

        % --- Connections ---
        % Signal tap from clock
        \coordinate (tapA) at (1,0);
        \draw [-] (clk.east) -- (tapA);
        \filldraw (tapA) circle (1.5pt);
        
        % Top Row Forward Wiring
        \draw [->] (tapA) -- (tan.west);
        \draw [->] (tan.east) -- (sum1.west);
        \draw [->] (sum1.east) -- (int1.west);
        
        % Signal tap after Integrator
        \coordinate (tapB) at (7,0);
        \draw [-] (int1.east) -- (tapB);
        \filldraw (tapB) circle (1.5pt);
        \draw [->] (tapB) |- (scopeTop); % Connect to Scope Top Port
        
        % Feedback Loop for Top Row
        % Routes down to y=-1, left to sum1's x-coordinate, then up
        \draw [->] (tapB) -- ++(0,-1) -| (sum1.south);
        
        % Middle Row Wiring
        \draw [->] (tapA) |- (poly.west);
        \draw [->] (poly.east) -- (sum2.west);
        \draw [->] (sum2.east) |- (scopeBot); % Connect to Scope Bottom Port
        
        % Bottom Row Wiring
        \draw [->] (tapA) |- (gainNeg.west);
        \draw [->] (gainNeg.east) -- (expu.west);
        \draw [->] (expu.east) -- (gain3.west);
        \draw [->] (gain3.east) -| (sum2.south); % Connects up into Sum2
        
    \end{tikzpicture}
    }
    \caption{Simulink Block Diagram: True Solution vs Approximate Solution}
\end{figure}


%-----------------------------------
\myproblem{Problem 13}
Construct a Simulink model to plot solutions for $0 \le t \le 2$:
\begin{align*}
\dot{x}_1 &= -6x_1 + 4x_2, \\
\dot{x}_2 &= 5x_1 - 7x_2 + f(t)
\end{align*}
where $f(t) = 3t$. Use the Ramp block in the Sources library.

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1.5cm]
        
        % --- Define Block Styles ---
        \tikzset{
            rampbox/.style = {draw, rectangle, minimum height=1.4cm, minimum width=1.4cm, fill=gray!10},
            ssblock/.style = {draw, rectangle, minimum height=1.4cm, minimum width=3cm, align=center, fill=gray!10},
            outblock/.style = {draw, rectangle, minimum height=1.4cm, minimum width=2.5cm, align=center, fill=gray!10}
        }

        % --- Nodes ---
        % 1. Ramp Block
        \node [rampbox] (ramp) {};
        % Draw the ramp symbol inside the block
        \draw [thick] ($(ramp.south west) + (0.2, 0.2)$) -- ($(ramp.south west) + (0.5, 0.2)$) -- ($(ramp.north east) + (-0.2, -0.2)$);
        
        % 2. State-Space Block
        \node [ssblock, right=of ramp] (ss) {
            \small $x' = Ax + Bu$ \\
            \small $y = Cx + Du$
        };
        
        % 3. Workspace / Simout Block
        \node [outblock, right=of ss] (simout) {simout};

        % --- Connections ---
        \draw [->] (ramp.east) -- (ss.west);
        \draw [->] (ss.east) -- (simout.west);

    \end{tikzpicture}
    \caption{Simulink State-Space Model for Problem 13}
\end{figure}

%-----------------------------------
\myproblem{Problem 15}
Construct a Simulink model to plot solutions for $0 \le t \le 10$:
\[\dot{x} = -5x + 3y + 5\sin 2t,\quad x(0)=0\]
\[\dot{y} = 3x - 4y,\quad y(0)=0\]

\begin{figure}[H]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            block/.style  = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            scope/.style  = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            wave/.style   = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            sum/.style    = {draw, circle, minimum size=0.8cm, inner sep=0pt},
            gainR/.style  = {draw, isosceles triangle, isosceles triangle apex angle=60,
                             minimum height=0.9cm, shape border rotate=0, inner sep=2pt},
            gainL/.style  = {draw, isosceles triangle, isosceles triangle apex angle=60,
                             minimum height=0.9cm, shape border rotate=180, inner sep=2pt},
        }

        %--- FORWARD PATH ---
        \node [wave]  (sine)  {$\sim$};
        \node [sum,   right=1.0cm of sine]   (sum1)   {};
        \node [block, right=1.0cm of sum1, label=below:{$x$}] (int1) {$\dfrac{1}{s}$};
        \node [gainR, right=1.0cm of int1]   (gain3f) {3};
        \node [sum,   right=0.9cm of gain3f] (sum2)   {};
        \node [block, right=1.0cm of sum2]   (int2)   {$\dfrac{1}{s}$};
        \node [scope, right=1.2cm of int2]   (scope)  {$\square$};

        %--- Sum1 labels: + left, - top, + bottom ---
        \node at ($(sum1.west)+(0.18, 0.08)$)  {\tiny $+$};
        \node at ($(sum1.north)+(0.10,-0.18)$) {\tiny $-$};
        \node at ($(sum1.south)+(0.10, 0.18)$) {\tiny $+$};

        %--- Sum2 labels: + left, - bottom ---
        \node at ($(sum2.west)+(0.18, 0.08)$)  {\tiny $+$};
        \node at ($(sum2.south)+(0.10, 0.18)$) {\tiny $-$};

        %--- FEEDBACK NODES ---
        \node [gainL, above=1.4cm of gain3f] (gain3b) {3};   % top feedback
        \node [gainL, below=1.4cm of int1]   (gain5)  {5};   % bottom-left feedback
        \node [gainL, below=1.4cm of int2]   (gain4)  {4};   % bottom-right feedback

        %--- TAP COORDINATES ---
        \coordinate (tap1) at ($(int1.east)!0.5!(gain3f.west)$);
        \coordinate (tap2) at ($(int2.east)!0.5!(scope.west)$);

        %--- FORWARD CONNECTIONS ---
        \draw [->] (sine)   -- (sum1);
        \draw [->] (sum1)   -- (int1);
        \draw [->] (int1)   -- (gain3f);
        \draw [->] (gain3f) -- (sum2);
        \draw [->] (sum2)   -- (int2);
        \draw [->] (int2)   -- (scope);

        %--- TAP DOTS ---
        \filldraw (tap1) circle (1.5pt);
        \filldraw (tap2) circle (1.5pt);

        %--- TOP FEEDBACK: tap2 -> gain3b -> sum1.north ---
        \draw [->] (tap2) |- (gain3b.east);
        \draw [->] (gain3b.west) -| (sum1.north);

        %--- BOTTOM-LEFT FEEDBACK: tap1 -> gain5 -> sum1.south ---
        \draw [->] (tap1) |- (gain5.east);
        \draw [->] (gain5.west) -| (sum1.south);

        %--- BOTTOM-RIGHT FEEDBACK: tap2 -> gain4 -> sum2.south ---
        \draw [->] (tap2) |- (gain4.east);
        \draw [->] (gain4.west) -| (sum2.south);

    \end{tikzpicture}
    }
    \caption{Simulink Block Diagram}
\end{figure}

%-----------------------------------
\myproblem{Problem 18}
Construct a Simulink model for $5\dot{x} + \sin x = f(t)$, $x(0) = 0$, where $g(t) = 10\sin 4t$ and:
\[f(t) = \begin{cases} -5 & \text{if } g(t) \le -5 \\ g(t) & \text{if } -5 < g(t) < 5 \\ 5 & \text{if } g(t) \ge 5 \end{cases}\]

\begin{figure}[H]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            block/.style   = {draw, rectangle, minimum height=1.1cm, minimum width=1.1cm, align=center},
            outblock/.style= {draw, rectangle, minimum height=1.0cm, minimum width=1.4cm, align=center},
            sum/.style     = {draw, circle, minimum size=0.8cm, inner sep=0pt},
            gainR/.style   = {draw, isosceles triangle, isosceles triangle apex angle=60,
                              minimum height=1.0cm, shape border rotate=0, inner sep=2pt},
        }

        % Sine Wave block
        \node [block, label=below:{\small Sine Wave\newline Function}] (sine) {%
            \begin{tikzpicture}[scale=0.22]
                \draw [thick] plot[domain=-pi:pi, samples=40] (\x, {sin(\x r)});
            \end{tikzpicture}
        };

        % Saturation block (S-curve)
        \node [block, right=1.0cm of sine, label=below:{\small Saturation}] (sat) {%
            \begin{tikzpicture}[scale=0.22]
                \draw [thick] plot[domain=-pi:pi, samples=40] (\x, {min(1,max(-1, \x*0.7))});
            \end{tikzpicture}
        };

        % Summing junction
        \node [sum, right=1.0cm of sat] (sum1) {};
        \node at ($(sum1.west)+(0.18, 0.08)$)  {\tiny $+$};
        \node at ($(sum1.south)+(0.10, 0.18)$) {\tiny $-$};

        % Gain block
        \node [gainR, right=0.8cm of sum1, label=below:{\small Gain}] (gain) {$\frac{1}{5}$};

        % Integrator block
        \node [block, right=1.0cm of gain, label=below:{\small Integrator}] (int1) {$\dfrac{1}{s}$};

        % To Workspace
        \node [outblock, right=1.2cm of int1, label=below:{\small To Workspace}] (ws) {\small simout};

        % Trigonometric Function block (feedback, below)
        \node [block, below=1.4cm of gain, label=below:{\small Trigonometric\newline Function}] (trig) {\small sin};

        % Tap between int1 and ws
        \coordinate (tap) at ($(int1.east)!0.5!(ws.west)$);
        \filldraw (tap) circle (1.5pt);

        % Forward connections
        \draw [->] (sine)  -- (sat);
        \draw [->] (sat)   -- (sum1);
        \draw [->] (sum1)  -- (gain);
        \draw [->] (gain)  -- (int1);
        \draw [->] (int1)  -- (ws);

        % Feedback: tap -> trig -> sum1.south
        \draw [->] (tap) |- (trig.east);
        \draw [->] (trig.west) -| (sum1.south);

    \end{tikzpicture}
    }
    \caption{Simulink Block Diagram}
\end{figure}

%-----------------------------------
\myproblem{Problem 25}
Use Transfer Function blocks to plot solutions for $0 \le t \le 2$:
\[3\ddot{x} + 15\dot{x} + 18x = f(t),\quad x(0)=\dot{x}(0)=0\]
\[2\ddot{y} + 16\dot{y} + 50y = x(t),\quad y(0)=\dot{y}(0)=0\]
where $f(t) = 75\,u_s(t)$.

\textbf{Problem 25}

Use Transfer Function blocks to plot solutions for $0 \leq t \leq 2$:
\begin{align*}
    3\ddot{x} + 15\dot{x} + 18x &= f(t), \quad x(0) = \dot{x}(0) = 0 \\
    2\ddot{y} + 16\dot{y} + 50y &= x(t), \quad y(0) = \dot{y}(0) = 0
\end{align*}
where $f(t) = 75\,u_s(t)$.

\textbf{Solution:} Taking the Laplace transform with zero initial conditions:
\begin{align*}
    X(s) &= \frac{1}{3s^2+15s+18} \cdot F(s) \\
    Y(s) &= \frac{1}{2s^2+16s+50} \cdot X(s)
\end{align*}
The input $f(t) = 75\,u_s(t)$ is a unit step scaled by 75. Connect a Step block
(amplitude $= 75$) into Transfer Fcn1, whose output feeds Transfer Fcn. Both $x(t)$
and $y(t)$ are collected via a Mux into the \texttt{simout} To~Workspace block.

\begin{figure}[H]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.4cm]
        \tikzset{
            stepblock/.style = {draw, rectangle, minimum height=1.1cm, minimum width=1.1cm, align=center},
            tfblock/.style   = {draw, rectangle, minimum height=1.2cm, minimum width=2.6cm, align=center},
            muxblock/.style  = {draw, rectangle, minimum height=1.4cm, minimum width=0.3cm,
                                align=center, fill=black},
            outblock/.style  = {draw, rectangle, minimum height=1.0cm, minimum width=1.4cm, align=center},
        }

        % Step block (amplitude = 75)
        \node [stepblock, label=below:{\small Step}] (step) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (-1,0) -- (0,0) -- (0,1) -- (1,1);
                \draw [dashed, thin] (-1,0) -- (1,0);
            \end{tikzpicture}
        };
        \node [below=0.05cm of step, yshift=0.4cm] {\tiny amp $= 75$};

        % Transfer Fcn 1
        \node [tfblock, right=1.2cm of step, label=below:{\small Transfer Fcn1}] (tf1) {%
            $\dfrac{1}{3s^2+15s+18}$
        };

        % Transfer Fcn 2
        \node [tfblock, right=1.4cm of tf1, label=below:{\small Transfer Fcn}] (tf2) {%
            $\dfrac{1}{2s^2+16s+50}$
        };

        % Mux block (solid black bar)
        \node [muxblock, right=1.4cm of tf2] (mux) {};

        % To Workspace
        \node [outblock, right=0.8cm of mux, label=below:{\small To Workspace}] (ws) {\small simout};

        % Tap coordinates
        \coordinate (tapX) at ($(tf1.east)!0.5!(tf2.west)$);
        \coordinate (tapY) at ($(tf2.east)!0.5!(mux.west)$);
        \filldraw (tapX) circle (1.5pt);
        \filldraw (tapY) circle (1.5pt);

        % Forward connections
        \draw [->] (step) -- (tf1);
        \draw [->] (tf1)  -- (tf2);
        \draw [->] (tf2.east) -- (mux.west);
        \draw [->] (mux)  -- (ws);

        % x(t) tap -> mux bottom input
        \draw [->] (tapX) -- ++(0,-1.6) -| (mux.south);

        % Wire labels
        \node [above, font=\small] at (tapX) {$x(t)$};
        \node [above, font=\small] at (tapY) {$y(t)$};

    \end{tikzpicture}
    }
    \caption{Simulink model for Problem 25}
\end{figure}

%-----------------------------------
\myproblem{Problem 28}
Create a Simulink model to plot the solution for $0 \le t \le 1$:
\[\frac{Y(s)}{F(s)} = \frac{4}{s+5}, \qquad f(t) = u_s(t) - u_s(t-1)\]

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            stepblock/.style = {draw, rectangle, minimum height=1.1cm, minimum width=1.1cm, align=center},
            tfblock/.style   = {draw, rectangle, minimum height=1.1cm, minimum width=1.8cm, align=center},
            scope/.style     = {draw, rectangle, minimum height=1.1cm, minimum width=1.1cm, align=center},
            sum/.style       = {draw, circle, minimum size=0.8cm, inner sep=0pt},
        }

        % Step blocks with internal step-function shape
        \node [stepblock, label=above left:{\small set start\newline time to 0}] (step1) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (-1, 0) -- (0, 0) -- (0, 1) -- (1, 1);
                \draw [dashed, thin] (-1, 0) -- (1, 0);
            \end{tikzpicture}
        };

        \node [stepblock, below=1.4cm of step1,
               label=below left:{\small set start\newline time to 1}] (step2) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (-1, 0) -- (0, 0) -- (0, 1) -- (1, 1);
                \draw [dashed, thin] (-1, 0) -- (1, 0);
            \end{tikzpicture}
        };

        % Summing junction (vertically centered between the two step blocks)
        \node [sum, right=1.2cm of step1, yshift=-0.8cm] (sum1) {};
        \node at ($(sum1.west)+(0.18, 0.08)$)  {\tiny $+$};
        \node at ($(sum1.south)+(0.10, 0.18)$) {\tiny $+$};

        % Transfer function block
        \node [tfblock, right=1.0cm of sum1] (tf) {$\dfrac{4}{s+5}$};

        % Scope
        \node [scope, right=1.2cm of tf] (scope) {$\square$};

        % Connections
        \draw [->] (step1.east) -- ++(0.4,0) |- (sum1.west);
        \draw [->] (step2.east) -- ++(0.4,0) |- (sum1.south);
        \draw [->] (sum1) -- (tf);
        \draw [->] (tf)   -- (scope);

    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}


%-----------------------------------
\myproblem{Problem 33}
Create a Simulink model for a mass supported by a nonlinear hardening spring, $0 \le t \le 2$:
\[5\ddot{y} = 5g - (900y + 1700y^3), \qquad y(0)=0.5,\;\dot{y}(0)=0\]
Use $g = 9.81$ m/s$^2$.



%-----------------------------------
\myproblem{Problem 35}
The equation for water height $h$ in a spherical tank (radius $r = 3$ m) with drain (radius 2 cm, $C_d = 0.5$), $h(0) = 5$ m:
\[\pi(2rh - h^2)\frac{dh}{dt} = -C_d A\sqrt{2gh}\]
Use Simulink to solve the nonlinear equation and plot $h(t)$ until $h(t) = 0$.

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            block/.style   = {draw, rectangle, minimum height=1.0cm, minimum width=1.0cm, align=center},
            outblock/.style= {draw, rectangle, minimum height=0.9cm, minimum width=1.4cm, align=center},
        }

        % Integrator block
        \node [block, label=below:{\small Integrator}] (int1) {$\dfrac{1}{s}$};

        % To Workspace block
        \node [outblock, right=1.2cm of int1, label=below:{\small To Workspace}] (ws) {\small simout};

        % Fcn block (feedback, below)
        \node [block, below=1.2cm of int1, label=below:{\small Fcn}] (fcn) {$f(u)$};

        % Tap coordinate between int1 and ws
        \coordinate (tap) at ($(int1.east)!0.5!(ws.west)$);
        \filldraw (tap) circle (1.5pt);

        % Forward connections
        \draw [->] (int1) -- (ws);

        % Input arrow into integrator
        \draw [->] ($(int1.west)+(-0.8,0)$) -- (int1.west);

        % Feedback: tap -> down -> fcn
        \draw [->] (tap) |- (fcn.east);

        % Fcn output -> back to integrator input
        \draw [->] (fcn.west) -- ++(-0.8,0) |- (int1.west);

    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}

%-----------------------------------
\myproblem{Problem 45}
Consider the system in Figure P45 with $m_1=m_2=1$, $c_1=3$, $c_2=1$, $k_1=1$, $k_2=4$:
\[m_1\ddot{x}_1 + (c_1+c_2)\dot{x}_1 + (k_1+k_2)x_1 - c_2\dot{x}_2 - k_2x_2 = 0\]
\[m_2\ddot{x}_2 + c_2\dot{x}_2 + k_2x_2 - c_2\dot{x}_1 - k_2x_1 = f(t)\]
\begin{itemize}
    \item[a.] Develop a Simulink model using state-variable representation.
    \item[b.] Plot $x_1(t)$ for zero initial conditions with piecewise input:
    \[f(t) = \begin{cases} t & 0 \le t \le 1 \\ 2-t & 1 < t < 2 \\ 0 & t \ge 2 \end{cases}\]
\end{itemize}


\begin{figure}[H]
    \centering
    \begin{tikzpicture}[>=Stealth, node distance=1cm and 1.2cm]
        \tikzset{
            rampblock/.style = {draw, rectangle, minimum height=1.1cm, minimum width=1.1cm, align=center},
            ssblock/.style   = {draw, rectangle, minimum height=1.4cm, minimum width=2.0cm, align=center},
            outblock/.style  = {draw, rectangle, minimum height=1.0cm, minimum width=1.4cm, align=center},
            sum/.style       = {draw, circle, minimum size=0.8cm, inner sep=0pt},
        }

        % Ramp blocks with diagonal line inside
        \node [rampblock, label=below:{\small Ramp}]  (ramp0) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (1,1);
            \end{tikzpicture}
        };
        \node [rampblock, below=0.8cm of ramp0, label=below:{\small Ramp1}] (ramp1) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (1,1);
            \end{tikzpicture}
        };
        \node [rampblock, below=0.8cm of ramp1, label=below:{\small Ramp2}] (ramp2) {%
            \begin{tikzpicture}[scale=0.25]
                \draw [thick] (-1,-1) -- (1,1);
            \end{tikzpicture}
        };

        % Summing junction aligned with ramp1
        \node [sum, right=1.2cm of ramp1] (sum1) {};
        \node at ($(sum1.north)+(0.10,-0.18)$) {\tiny $+$};
        \node at ($(sum1.west)+(0.18, 0.08)$)  {\tiny $+$};
        \node at ($(sum1.south)+(0.10, 0.18)$) {\tiny $+$};

        % State-Space block
        \node [ssblock, right=1.2cm of sum1, label=below:{\small State-Space}] (ss) {%
            \small $x' = Ax+Bu$\\
            \small $y = Cx+Du$
        };

        % To Workspace
        \node [outblock, right=1.2cm of ss, label=below:{\small To Workspace}] (ws) {\small simout};

        % Connections
        \draw [->] (ramp0.east) -- ++(0.4,0) |- (sum1.north);
        \draw [->] (ramp1.east) -- (sum1.west);
        \draw [->] (ramp2.east) -- ++(0.4,0) |- (sum1.south);
        \draw [->] (sum1) -- (ss);
        \draw [->] (ss)   -- (ws);

    \end{tikzpicture}
    \caption{Simulink Block Diagram}
\end{figure}